enclave {
    
    /* Import OCALL for the threading function.
     */
    
    from "sgx_tstdc.edl" import sgx_thread_wait_untrusted_event_ocall, sgx_thread_set_untrusted_event_ocall, sgx_thread_setwait_untrusted_events_ocall, sgx_thread_set_multiple_untrusted_events_ocall;

    /* 
     * run_test - run the target test inside the enclave.
     */
    trusted {    
        public void run_test([out] int* return_code);
    };
    
    /* 
     * ocall_print_string - invokes OCALL to print a string buffer 
     *                      coming from the enclave to the test's .res file.
     *  [in]: copy the string buffer to App outside.
     *  [string]: specifies 'str' is a NULL terminated buffer.
     */
    untrusted {
        void ocall_print_string([in, string] const char *str);
    };

    /* 
     * ocall_log_string - invokes OCALL to log string buffer inside the enclave.
     *                    This will print the string in the test's .log file.
     *  [in]: copy the string buffer to App outside.
     *  [string]: specifies 'str' is a NULL terminated buffer.
     */
    untrusted {
        void ocall_log_string([in, string] const char *str);
    };
};
